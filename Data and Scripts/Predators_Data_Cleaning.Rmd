---
title: "Predators_Data_Cleaning"
author: "Micaela Chapuis"
date: "2024-07-12"
output: html_document
---

```{r}
library("dplyr")
library("lubridate")
library("ggplot2")
```

## Whelks

```{r}
whelk <- read.csv("Data/whelk_data.csv")
```

### Data Cleaning
Recode "28 + whelk eggs" data point to just "28" and switch Number to numeric

```{r}
whelk$Number <- dplyr::recode(whelk$Number, "28 + whelk eggs" = "28")
whelk$Number <- as.numeric(whelk$Number)
```

Recode Date column + turn into Date format (changing 15-Jul-14 to 14-Jul-14 to combine those)

```{r}
whelk$Date <- dplyr::recode(whelk$Date, "6/18/2014" = "2014-06-18", "6/19/2014" = "2014-06-19", "6/27/2014" = "2014-06-27", "7/15/2014" = "2014-07-14", "7/14/2014" = "2014-07-14", "8/11/2014" = "2014-08-11", "10/1/2015" = "2015-10-01", "7/14/2017" = "2017-07-14", "5/17/2021" = "2021-05-17", "7/7/2023" = "2023-07-07", "12/12/2023" = "2023-12-12", "3/8/2024" = "2024-03-08")
whelk$Date <- as.Date(whelk$Date)
```

Fix name of "Plot" column

```{r}
names(whelk)[3] <- "Plot"
```

Change name of "Number" column to be more descriptive

```{r}
names(whelk)[4] <- "Num.Whelks"
```

Filter out B plots and making new df "whelks" without them (Whelk quadrats, which are smaller than mussel quadrats, were supposed to be put in between the A and B plots, right on their shared border. At some point, people collected whelk data for the A and the B plots separately. We chose to only keep the A plots since not all plots have B plots)
```{r}
B.plots <- c("1B", "2B", "3B", "5B", "6B", "7B", "9B", "10B")
whelks <- whelk %>% filter(!Plot %in% B.plots)
```

Recode A plots to WholePlot numbers

```{r}
whelks$Plot <- dplyr::recode(whelks$Plot, "1A" = "1", "2A" = "2", "3A" = "3", "4A" = "4", "5A" = "5", "6A" = "6", "7A" = "7", "8A" = "8", "9A" = "9", "10A" = "10")
```

Change Date to date and Site and Plot to factor

```{r}
whelks$Date <- as.Date(whelks$Date, "%Y-%m-%d")
whelks$Site <- as.factor(whelks$Site)
whelks$Plot <- as.factor(whelks$Plot)
```

Create column for just year

```{r}
whelks$Year <- year(whelks$Date)
```


### Raw Data Figure
```{r}
group.colors <- c(West = "#ff6361", East = "#619eff")
```

###### Fig S1D - Whelk Abundance Raw Data
```{r}
FigS1D <- whelks %>% 
  ggplot(mapping=aes(x = Date, y = Num.Whelks, color = Site)) + 
      labs (x = "Date", y = "Whelk Abundance (# whelks/0.25m2") + 
      theme(panel.background = element_blank(), 
          axis.line = element_line (colour = "black"), 
          axis.text = element_text(size = 32),
                axis.text.x = element_text(angle = 0, hjust = 0.5),
          axis.title = element_text(size = 36),
          legend.position = "none") + 
      geom_point (size=4, alpha = 0.7) + 
      scale_x_date(limits = as.Date(c("2014-01-01", "2024-04-01"))) +
    theme(plot.title = element_text(hjust = 0.5, size=30, face="bold"))+
  scale_color_manual(values=group.colors) +
  scale_fill_manual(values=group.colors) 

FigS1D
#ggsave("figS1D.png", height=3, width=3,scale = 3)

```




## Seastars

```{r}
seastars <- read.csv("Data/seastar_data.csv")
```

Changing name of Count column to Num.Seastars

```{r}
names(seastars)[3] <- "Num.Seastars"
```

### Raw Data Figure
#####FigS1C - Seastar Abundace Raw Data (2014-2024)

```{r}
FigS1C <- seastars %>% 
  subset(Year>2013) %>%
  ggplot(mapping=aes(x = Year, y = Num.Seastars, color = Site)) + 
  labs (x = "Date", y = "Sea Star Abundance (# sea stars/site)") + 
  theme(panel.background = element_blank(), 
        axis.line = element_line (colour = "black"), 
        axis.text = element_text(size = 32),
              axis.text.x = element_text(angle = 0, hjust = 0.5),
        axis.title = element_text(size = 36),
        legend.text = element_text(size = 32),
        legend.title = element_text(size = 36)) + 
  geom_point (size=4, alpha = 0.7, position="jitter") + 
  theme(plot.title = element_text(hjust = 0.5, size=35, face="bold")) +
  scale_x_continuous(breaks = c(2014, 2016, 2018, 2020, 2022, 2024)) +
  scale_color_manual(values=group.colors) +
  scale_fill_manual(values=group.colors)

FigS1C

#ggsave("figS1C.png", height=3, width=3,scale = 3)

```